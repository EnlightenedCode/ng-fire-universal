<nav
  [class.expanded]="nav.isHeaderMenuExpanded"
  [class.offline]="platform.isBrowser() && !platform.isOnline()">
  <div class="top">
    <a
      class="logo"
      routerLink="/"
      (click)="nav.collapseHeader()">ng-fire-universal</a>
    <div
      class="menu-toggle"
      [class.active]="nav.isHeaderMenuExpanded"
      (click)="nav.toggleMenu($event)">
      <i class="fa fa-bars"></i>
    </div>
  </div>

  <!-- Logged-in -->
  <div
    class="menu-container"
    [class.expanded]="nav.isHeaderMenuExpanded"
    *ngIf="auth.user | async as user; else isStatic"
    (click)="nav.collapseHeader()">
    <ul
      class="menu logged-in"
      [class.expanded]="nav.isHeaderMenuExpanded || nav.isHeaderAccountMenuExpanded">
      <li class="menu-item">
        <a
          class="menu-link store-link"
          routerLink="/store"
          routerLinkActive="active">
          <i class="fas fa-store mr-2"></i> Store
        </a>
      </li>
      <li class="menu-item">
        <a
          class="menu-link cart-link"
          routerLink="/cart"
          routerLinkActive="active">
          <i class="fas fa-shopping-cart mr-2">
            <span>0</span>
          </i>
          <span>My&nbsp;</span>Cart
          <span class="count">&nbsp;(0)</span>
        </a>
      </li>
      <li
        class="menu-item dropdown"
        *ngIf="user">
        <div
          class="menu-link dropdown-toggle"
          (click)="nav.toggleAccountMenu($event)"
          [class.expanded]="nav.isHeaderAccountMenuExpanded">
          <span class="avatar">
            <img
              [class.inactive]="!user.active"
              [class.disabled]="!user.photoURL"
              [src]="user.photoURL">
            <i
              class="fas fa-user"
              *ngIf="user.active && !user.photoURL"></i>
          </span>
        </div>
        <div
          class="dropdown-menu"
          [class.expanded]="nav.isHeaderAccountMenuExpanded">
          <a
            class="dropdown-item"
            routerLink="/me"
            routerLinkActive="active">My Account</a>
          <a
            class="dropdown-item"
            routerLink="/admin"
            routerLinkActive="active"
            *ngIf="auth.isAdmin">Admin</a>
          <div class="dropdown-divider"></div>
          <a
            href="#"
            class="dropdown-item sign-out"
            (click)="signOut()">Sign Out</a>
        </div>
      </li>
    </ul>
  </div>

  <!-- Logged-out / initial render (server-side) -->
  <ng-template #isStatic>
    <ul
      class="menu"
      [class.expanded]="nav.isHeaderMenuExpanded || nav.isHeaderAccountMenuExpanded"
      (click)="nav.collapseHeader()"
      *ngIf="!(auth.isLoading | async)">
      <li class="menu-item">
        <a
          class="menu-link store-link"
          routerLink="/store"
          routerLinkActive="active">
          <i class="fas fa-store mr-2"></i> Store
        </a>
      </li>
      <li class="menu-item">
        <a
          class="menu-link cart-link"
          routerLink="/cart"
          routerLinkActive="active">
          <i class="fas fa-shopping-cart mr-2">
            <span>0</span>
          </i>
          <span>My&nbsp;</span>Cart
          <span class="count">&nbsp;(0)</span>
        </a>
      </li>
      <li class="menu-item">
        <a
          class="menu-link"
          routerLink="/signup"
          routerLinkActive="active">
          <i class="fas fa-fire mr-2"></i> Sign Up
        </a>
      </li>
      <li class="menu-item">
        <a
          class="menu-link"
          routerLink="/login"
          routerLinkActive="active">
          <i class="fas fa-sign-in-alt mr-2"></i> Login
        </a>
      </li>
    </ul>
  </ng-template>
</nav>

<!-- Offline / PWA -->
<div
  class="offline-warning"
  *ngIf="platform.isBrowser() && !platform.isOnline()">
  <div class="container">
    <span>
      <i class="fa fa-warning mr-2"></i>
      Offline / Connection Lost
    </span>
  </div>
</div>
